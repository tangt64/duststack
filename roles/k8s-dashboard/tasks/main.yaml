- name: copy dashboard materials on master 
  copy:
    src: "{{ item }}"
    dest: /tmp/
  with_items:
    - dashboard.yaml
    - dashboard-rbac.yaml

- name: create kubernetes dashboard rbac
  command: kubectl apply -f /tmp/dashboard-rbac.yaml

- name: enable kubernetes dashboard
  command: kubectl apply -f /tmp/dashboard.yaml

- name: get token for access to kubernetes dashboard
  shell: kubectl -n kube-system describe $(kubectl -n kube-system get secret -n kube-system -o name | grep namespace) | grep token
  register: k8s_token

- name: show the token for access to kubernetes dashboard
  debug:
    msg: "{{ k8s_token }}"  